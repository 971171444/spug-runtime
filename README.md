# Spug Enhanced Runtime

> **åŸºäº [Spug](https://github.com/openspug/spug) äºŒæ¬¡å¼€å‘çš„å¢å¼ºç‰ˆå®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒ**

[![License](https://img.shields.io/badge/license-AGPL--3.0-blue.svg)](https://opensource.org/licenses/AGPL-3.0)
[![Based on Spug](https://img.shields.io/badge/based%20on-Spug-green.svg)](https://github.com/openspug/spug)

## ğŸ“‹ é¡¹ç›®è¯´æ˜

æœ¬é¡¹ç›®åŸºäº [Spug](https://github.com/openspug/spug) å¼€æºè¿ç»´å¹³å°è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä¸»è¦é’ˆå¯¹å®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒè¿›è¡Œäº†åŠŸèƒ½å¢å¼ºå’Œä¼˜åŒ–ã€‚

**åŸé¡¹ç›®ä¿¡æ¯**ï¼š
- åŸé¡¹ç›®åœ°å€ï¼šhttps://github.com/openspug/spug
- åŸé¡¹ç›®å®˜ç½‘ï¼šhttps://www.spug.cc
- åŸé¡¹ç›®æ–‡æ¡£ï¼šhttps://ops.spug.cc/docs/about-spug/
- åŸé¡¹ç›®è®¸å¯è¯ï¼šAGPL-3.0

**æœ¬é¡¹ç›®éµå¾ªåŸé¡¹ç›®çš„å¼€æºåè®®ï¼Œä»…å¯¹å®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒè¿›è¡Œå¢å¼ºï¼Œä¸æ¶‰åŠæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¿®æ”¹ã€‚**

## âœ¨ å¢å¼ºåŠŸèƒ½

### 1. å¤–éƒ¨ Redis æ”¯æŒ
- âœ… æ”¯æŒè¿æ¥å¤–éƒ¨ Redis æœåŠ¡å™¨
- âœ… æ”¯æŒ Redis å¯†ç è®¤è¯
- âœ… æ”¯æŒè‡ªå®šä¹‰ Redis æ•°æ®åº“ç¼–å·
- âœ… è‡ªåŠ¨å¤„ç† Redis å¯†ç ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆURL ç¼–ç ï¼‰

### 2. çµæ´»çš„è¿è¡Œæ—¶ç¯å¢ƒåˆ‡æ¢
- âœ… **JDK ç‰ˆæœ¬åˆ‡æ¢**ï¼šæ”¯æŒå¤šç‰ˆæœ¬ JDKï¼ˆ8, 17, 21, 22 ç­‰ï¼‰
- âœ… **Maven ç‰ˆæœ¬åˆ‡æ¢**ï¼šæ”¯æŒå¤šç‰ˆæœ¬ Mavenï¼ˆ3.6.3, 3.9.11 ç­‰ï¼‰
- âœ… **Node.js ç‰ˆæœ¬åˆ‡æ¢**ï¼šæ”¯æŒå¤šç‰ˆæœ¬ Node.jsï¼ˆ14, 16, 18, 20, 22 ç­‰ï¼‰
- âœ… é€šè¿‡æŒ‚è½½ç›®å½•æ–¹å¼æä¾›ç‰ˆæœ¬åŒ…ï¼ŒæŒ‰éœ€è§£å‹ä½¿ç”¨
- âœ… æä¾›ä¾¿æ·çš„å‘½ä»¤è¡Œå·¥å…·ï¼š`usejdk`ã€`usemvn`ã€`usenode`

### 3. é•œåƒä¼˜åŒ–
- âœ… ç§»é™¤å†…ç½®çš„ JDK/Maven/Node.js å®‰è£…åŒ…ï¼Œå¤§å¹…å‡å°é•œåƒä½“ç§¯
- âœ… ä½¿ç”¨ Ubuntu 22.04 LTS ä½œä¸ºåŸºç¡€é•œåƒï¼ˆæ›´ç¨³å®šã€æ›´ç°ä»£ï¼‰
- âœ… ä¼˜åŒ–æ„å»ºå±‚æ•°ï¼Œå‡å°‘é•œåƒå¤§å°

### 4. å…¶ä»–ä¼˜åŒ–
- âœ… ä¿®å¤ Redis å¯†ç è®¤è¯é—®é¢˜
- âœ… ä¿®å¤ Nginx ç”¨æˆ·æƒé™é—®é¢˜
- âœ… ä¼˜åŒ– Python ä¾èµ–ç‰ˆæœ¬å…¼å®¹æ€§
- âœ… æ”¹è¿›å®¹å™¨å¯åŠ¨è„šæœ¬

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Docker å’Œ Docker Compose
- å¤–éƒ¨ MySQL æ•°æ®åº“ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä½¿ç”¨ Docker Compose ä¸­çš„æ•°æ®åº“ï¼‰
- å¤–éƒ¨ Redis æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼Œä¹Ÿå¯ä½¿ç”¨ Docker Compose ä¸­çš„ Redisï¼‰

### 1. å‡†å¤‡ç‰ˆæœ¬åŒ…ç›®å½•

åœ¨å®¿ä¸»æœºä¸Šåˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„ï¼Œå¹¶æ”¾å…¥å¯¹åº”çš„ç‰ˆæœ¬åŒ…ï¼š

```bash
/path/to/versions/
â”œâ”€â”€ jdk/          # JDK ç‰ˆæœ¬åŒ…ç›®å½•
â”‚   â”œâ”€â”€ OpenJDK8U-jdk_x64_linux_hotspot_8u472b08.tar.gz
â”‚   â”œâ”€â”€ OpenJDK17U-jdk_x64_linux_hotspot_17.0.17_10.tar.gz
â”‚   â””â”€â”€ OpenJDK21U-jdk_x64_linux_hotspot_21.0.9_10.tar.gz
â”œâ”€â”€ maven/        # Maven ç‰ˆæœ¬åŒ…ç›®å½•
â”‚   â”œâ”€â”€ apache-maven-3.6.3-bin.tar.gz
â”‚   â””â”€â”€ apache-maven-3.9.11-bin.tar.gz
â””â”€â”€ node/         # Node.js ç‰ˆæœ¬åŒ…ç›®å½•
    â”œâ”€â”€ node-v14.21.3-linux-x64.tar.gz
    â”œâ”€â”€ node-v16.19.0-linux-x64.tar.gz
    â”œâ”€â”€ node-v18.20.4-linux-x64.tar.gz
    â””â”€â”€ node-v20.10.0-linux-x64.tar.gz
```

### 2. æ„å»ºé•œåƒ

```bash
git clone https://github.com/971171444/spug-enhanced-runtime.git
cd spug-enhanced-runtime
docker build -t spug-enhanced:latest .
```

### 3. é…ç½® Docker Compose

åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: "3.3"
services:
  spug:
    image: spug-enhanced:latest
    container_name: spug
    privileged: true
    restart: always
    volumes:
      # æŒ‚è½½ç‰ˆæœ¬åŒ…ç›®å½•ï¼ˆåªè¯»ï¼‰
      - /path/to/versions/jdk:/opt/ext/jdk:ro
      - /path/to/versions/maven:/opt/ext/maven:ro
      - /path/to/versions/node:/opt/ext/node:ro
      # æ•°æ®ç›®å½•ï¼ˆå¯é€‰ï¼‰
      # - ./spug:/data/spug:rw
    ports:
      - "18083:80"
    environment:
      # MySQL é…ç½®
      - MYSQL_DATABASE=spug
      - MYSQL_USER=spug
      - MYSQL_PASSWORD=your_password
      - MYSQL_HOST=10.0.2.23        # å¤–éƒ¨ MySQL åœ°å€
      - MYSQL_PORT=9307              # å¤–éƒ¨ MySQL ç«¯å£
      # Redis é…ç½®
      - REDIS_HOST=192.168.1.147     # å¤–éƒ¨ Redis åœ°å€
      - REDIS_PORT=9379              # å¤–éƒ¨ Redis ç«¯å£
      - REDIS_PASSWORD=Shkj@123!@#   # Redis å¯†ç ï¼ˆæ”¯æŒç‰¹æ®Šå­—ç¬¦ï¼‰
      - REDIS_DB=8                    # Redis æ•°æ®åº“ç¼–å·
```

### 4. å¯åŠ¨æœåŠ¡

```bash
docker-compose up -d
```

### 5. åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·

```bash
docker exec spug init_spug admin spug.cc
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç‰ˆæœ¬åˆ‡æ¢å‘½ä»¤

è¿›å…¥å®¹å™¨åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ‡æ¢è¿è¡Œæ—¶ç‰ˆæœ¬ï¼š

```bash
# è¿›å…¥å®¹å™¨
docker exec -it spug bash

# åˆ‡æ¢ JDK ç‰ˆæœ¬
usejdk 17        # åˆ‡æ¢åˆ° JDK 17
java -version    # éªŒè¯

# åˆ‡æ¢ Maven ç‰ˆæœ¬ï¼ˆéœ€è¦å…ˆåˆ‡æ¢ JDKï¼‰
usejdk 17        # å…ˆåˆ‡æ¢ JDK
usemvn 3.9.11    # åˆ‡æ¢åˆ° Maven 3.9.11
mvn -v           # éªŒè¯

# åˆ‡æ¢ Node.js ç‰ˆæœ¬
usenode 20       # åˆ‡æ¢åˆ° Node.js 20
node -v          # éªŒè¯
```

**æ³¨æ„**ï¼š
- ç‰ˆæœ¬åŒ…ä¼šåœ¨é¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨è§£å‹åˆ°å®¹å™¨å†…çš„ `/opt/ext` ç›®å½•
- ç¯å¢ƒå˜é‡ä¼šåœ¨å½“å‰ shell ä¼šè¯ä¸­ç”Ÿæ•ˆ
- å¦‚æœè¿›å…¥å®¹å™¨åå‘½ä»¤ä¸ç”Ÿæ•ˆï¼Œæ‰§è¡Œ `source /root/.bashrc` é‡æ–°åŠ è½½

### ç‰ˆæœ¬åŒ…å‘½åè§„åˆ™

è„šæœ¬æ”¯æŒä»¥ä¸‹å‘½åæ¨¡å¼ï¼š

**JDK**ï¼š
- `jdk8.tar.gz`ã€`jdk17.tar.gz` ç­‰
- `OpenJDK*8*.tar.gz`ã€`OpenJDK*17*.tar.gz` ç­‰ï¼ˆæ¨¡å¼åŒ¹é…ï¼‰

**Maven**ï¼š
- `apache-maven-3.6.3-bin.tar.gz`ã€`apache-maven-3.9.11-bin.tar.gz` ç­‰
- `maven-3.6.3.tar.gz` ç­‰ï¼ˆæ¨¡å¼åŒ¹é…ï¼‰

**Node.js**ï¼š
- `node-v14.21.3-linux-x64.tar.gz`ã€`node-v20.10.0-linux-x64.tar.gz` ç­‰
- `node-v14*.tar.gz`ã€`node-v20*.tar.gz` ç­‰ï¼ˆæ¨¡å¼åŒ¹é…ï¼‰

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| `MYSQL_DATABASE` | MySQL æ•°æ®åº“å | `spug` | æ˜¯ |
| `MYSQL_USER` | MySQL ç”¨æˆ·å | `spug` | æ˜¯ |
| `MYSQL_PASSWORD` | MySQL å¯†ç  | - | æ˜¯ |
| `MYSQL_HOST` | MySQL ä¸»æœºåœ°å€ | `127.0.0.1` | æ˜¯ |
| `MYSQL_PORT` | MySQL ç«¯å£ | `3306` | æ˜¯ |
| `REDIS_HOST` | Redis ä¸»æœºåœ°å€ | `127.0.0.1` | æ˜¯ |
| `REDIS_PORT` | Redis ç«¯å£ | `6379` | æ˜¯ |
| `REDIS_PASSWORD` | Redis å¯†ç  | - | å¦ |
| `REDIS_DB` | Redis æ•°æ®åº“ç¼–å· | `1` | å¦ |

### æŒ‚è½½ç›®å½•

| æŒ‚è½½è·¯å¾„ | è¯´æ˜ | æƒé™ |
|---------|------|------|
| `/opt/ext/jdk` | JDK ç‰ˆæœ¬åŒ…ç›®å½• | åªè¯» |
| `/opt/ext/maven` | Maven ç‰ˆæœ¬åŒ…ç›®å½• | åªè¯» |
| `/opt/ext/node` | Node.js ç‰ˆæœ¬åŒ…ç›®å½• | åªè¯» |
| `/data/spug` | Spug æ•°æ®ç›®å½• | è¯»å†™ |

## ğŸ› æ•…éšœæ’æŸ¥

### 1. å®¹å™¨æ— æ³•å¯åŠ¨

æ£€æŸ¥æ—¥å¿—ï¼š
```bash
docker logs spug
```

å¸¸è§é—®é¢˜ï¼š
- Redis è¿æ¥å¤±è´¥ï¼šæ£€æŸ¥ `REDIS_HOST`ã€`REDIS_PORT`ã€`REDIS_PASSWORD` é…ç½®
- MySQL è¿æ¥å¤±è´¥ï¼šæ£€æŸ¥ç½‘ç»œè¿é€šæ€§å’Œ MySQL é…ç½®

### 2. ç‰ˆæœ¬åˆ‡æ¢å‘½ä»¤ä¸ç”Ÿæ•ˆ

```bash
# é‡æ–°åŠ è½½å‡½æ•°å®šä¹‰
source /root/.bashrc

# æˆ–é‡æ–°è¿›å…¥å®¹å™¨
docker exec -it spug bash
```

### 3. æ‰¾ä¸åˆ°ç‰ˆæœ¬åŒ…

- ç¡®è®¤ç‰ˆæœ¬åŒ…å·²æ­£ç¡®æŒ‚è½½åˆ°å®¹å™¨å†…
- æ£€æŸ¥ç‰ˆæœ¬åŒ…å‘½åæ˜¯å¦ç¬¦åˆè§„åˆ™
- æŸ¥çœ‹å®¹å™¨å†…ç›®å½•ï¼š`docker exec spug ls -la /opt/ext/jdk`

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-XX)
- âœ… æ”¯æŒå¤–éƒ¨ Redisï¼ˆå¸¦å¯†ç ï¼‰
- âœ… å®ç° JDK/Maven/Node.js ç‰ˆæœ¬åˆ‡æ¢åŠŸèƒ½
- âœ… ä¼˜åŒ–é•œåƒä½“ç§¯
- âœ… ä¿®å¤ Redis å¯†ç è®¤è¯é—®é¢˜
- âœ… ä¿®å¤ Nginx ç”¨æˆ·æƒé™é—®é¢˜

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [Spug](https://github.com/openspug/spug) äºŒæ¬¡å¼€å‘ï¼Œéµå¾ªåŸé¡¹ç›®çš„ [AGPL-3.0](https://opensource.org/licenses/AGPL-3.0) è®¸å¯è¯ã€‚

**é‡è¦å£°æ˜**ï¼š
- æœ¬é¡¹ç›®ä»…å¯¹å®¹å™¨è¿è¡Œæ—¶ç¯å¢ƒè¿›è¡Œå¢å¼ºï¼Œä¸æ¶‰åŠ Spug æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¿®æ”¹
- æœ¬é¡¹ç›®éµå¾ªåŸé¡¹ç›®çš„å¼€æºåè®®ï¼Œå°Šé‡åŸä½œè€…çš„ç‰ˆæƒ
- ä½¿ç”¨æœ¬é¡¹ç›®æ—¶ï¼Œè¯·éµå®ˆåŸé¡¹ç›®çš„è®¸å¯è¯è¦æ±‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ [Spug](https://github.com/openspug/spug) é¡¹ç›®æä¾›ä¼˜ç§€çš„å¼€æºè¿ç»´å¹³å°
- æ„Ÿè°¢æ‰€æœ‰ä¸º Spug é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…

## ğŸ“® è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issueï¼šhttps://github.com/971171444/spug-enhanced-runtime/issues
- åŸé¡¹ç›®å®˜ç½‘ï¼šhttps://www.spug.cc

---

**âš ï¸ å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä¸ºä¸ªäººå­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œä¸å¯¹ä½¿ç”¨æœ¬é¡¹ç›®é€ æˆçš„ä»»ä½•æŸå¤±è´Ÿè´£ã€‚è¯·åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰å……åˆ†æµ‹è¯•ã€‚
